<launch>
  <!-- 
    Navigation and Exploration Launch File - FOR GAZEBO SIMULATION
    Designed for Agilex Scout v2 with RSLidar, RealSense, and xArm6.
    
    This launch file runs SLAM (gmapping), navigation stack, and autonomous exploration
    for Gazebo simulation. It is optimized to run inside Docker container with Gazebo running.
    
    Features:
    - SLAM: gmapping for map building
    - Navigation: move_base with TEB local planner and GlobalPlanner
    - Exploration: explore_lite for autonomous frontier-based exploration
    
    BEFORE RUNNING:
    1. Start Gazebo with robot:
       roslaunch scout_xarm_complete scout_with_xarm_empty_world.launch
       (or use your preferred Gazebo world)
    
    2. In another terminal (inside Docker), run this launch file:
       roslaunch scout_xarm_navigation nav_explore.launch
    
    Prerequisites:
    - Gazebo must be running with the robot spawned
    - Robot must publish /scan (from lidar or pointcloud_to_laserscan)
    - Robot must publish /odom and TF transforms (odom->base_link)
    - Robot must subscribe to /cmd_vel for base control
  -->

  <launch>
    <arg name="run_explore" default="true"/>

    <include file="$(find scout_xarm_navigation)/launch/slam_gmapping.launch"/>
    <include file="$(find scout_xarm_navigation)/launch/move_base.launch"/>

    <node if="$(arg run_explore)" pkg="explore_lite" type="explore" respawn="false" name="explore" output="screen">
        <param name="robot_base_frame" value="base_link"/>
        <param name="costmap_topic" value="/map"/>
        <param name="costmap_updates_topic" value="/map_updates"/>
        <param name="visualize" value="true"/>
        <param name="planner_frequency" value="0.05"/>
        <param name="progress_timeout" value="120.0"/>
        <param name="potential_scale" value="3.0"/>
        <param name="orientation_scale" value="0.0"/>
        <param name="gain_scale" value="1.0"/>
        <param name="transform_tolerance" value="0.3"/>
        <param name="min_frontier_size" value="0.75"/>
    </node>
    <arg name="run_rviz" default="true"/>
    <node if="$(arg run_rviz)" pkg="rviz" type="rviz" name="rviz" respawn="false" output="screen"
         args="-d $(find scout_xarm_navigation)/rviz.rviz"/>
</launch>

